# Jenkins installation on a GKE cluster

* Creation and configuration (RBAC) of cluster to allow Jenkins installation
* Helm (Tiller) install to deploy Jenkins on GKE as a chart

The process is performed automatically by running `jenkins-intallation/setup.sh` following the explanations in https://cloud.google.com/solutions/jenkins-on-kubernetes-engine-tutorial. Please, take a look at it for additional comments on the installation process and possible workarounds.

After the correct installation of Jenkins, we can access Jenkins server using port redirection of out pod:
```sh
$ export POD_NAME=$(kubectl get pods -o jsonpath="{.items[0].metadata.name}")
$ kubectl port-forward $POD_NAME 8080:8080 >> /dev/null &
$ printf $(kubectl get secret cd-jenkins -o jsonpath="{.data.jenkins-admin-password}" | base64 --decode);echo
```

The last line prints the autogenerated password generated by the Chart installation needed to login on Jenkins.

If we take a look to `kubectl get services -o wide`, two services for Jenkins master are shown, both ClusterIP types, one serving on port 5000 (used by the executors to talk to the master) and 8080 to access to the UI. In this case, as we have redirected our ports, we can access to the UI although it is a private ClusterIP service. This is the default service creation performed by the Jenkins chart we used. If we want our Jenkins master service to be accessed from outside, we can run

```sh
$ kubectl create -f master-ui-service.yaml
```

and use the provided "external-ip" to access Jenkins in `external-ip:8080` as the created service is type LoadBalancer.
